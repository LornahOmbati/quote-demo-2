import React, { useState, useRef, useEffect } from 'react';
import './Invoice.css';
// import cinelogo3 from './images/cinelogo3.png';
import html2pdf from 'html2pdf.js';
import { collection, addDoc, getDocs } from 'firebase/firestore';
import { db } from '../firebase'; // Ensure this is the correct path to your Firebase config
import { query, where} from 'firebase/firestore';
import { orderBy, startAt, endAt } from 'firebase/firestore';
import debounce from 'lodash.debounce';
import { limit } from 'firebase/firestore';


function Invoice({ moduleName, userId }) {
  const [documentType, setDocumentType] = useState('Invoice'); // New state for document type

  const [isSaving, setIsSaving] = useState(false);


  const [InvoiceId, setInvoiceId] = useState(''); // ID for the document
  const [items, setItems] = useState([]);
  const [currency, setCurrency] = useState('USD'); // State for selected currency
  const [clientName, setClientName] = useState('');
  const [jobName, setJobName] = useState('');
    const [clients, setClients] = useState([]);
  

  const [clientAddress, setClientAddress] = useState('');
  const [email, setEmail] = useState('');
  const [attentionTo, setAttentionTo] = useState(''); // New State for Attention To
  const [date, setDate] = useState(new Date().toISOString().slice(0, 10));
  const [additionalNotes, setAdditionalNotes] = useState(''); // State for Additional Notes
  const [editIndex, setEditIndex] = useState(-1); // -1 means no item is being edited


  const [discount, setDiscount] = useState(0); // New: Discount percentage
  const [showModal, setShowModal] = useState(false);
  const [itemDescription, setItemDescription] = useState('');
  const [itemQuantity, setItemQuantity] = useState(1);
  const [itemPrice, setItemPrice] = useState(0);
  const [itemDays, setItemDays] = useState(1); // New state for item days

  const CinelogoBase64 = 'data:image/jpeg;base64,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';


  const [vatRate, setVatRate] = useState(16); // New VAT rate state

  const [showTermsModal, setShowTermsModal] = useState(false); // State for new terms modal

  const componentRef = useRef(null);



const saveClient = async (clientData, moduleName, userId) => {

    if (!userId) {
      console.error('User ID is undefined. Cannot save client.');
      return;
  }
    const collectionName = moduleName === 'primegear' ? 'primegear_clients' : 'cine_clients';
    console.log('Saving client to collection:', collectionName, 'with data:', clientData);

    try {
        const clientsCollection = collection(db, collectionName);

        // Check for duplicates
        const q = query(clientsCollection, where("clientName", "==", clientData.clientName), where("userId", "==", userId));
        const existingDocs = await getDocs(q);

        if (existingDocs.empty) {
          await addDoc(clientsCollection, { ...clientData, userId });
          console.log('Client added successfully.');
          } else {
              alert('Client already exists.');
          }
    
    } catch (error) {
        console.error('Error saving client to Firestore:', error);
    }
};


const fetchClients = async (prefix, moduleName, userId) => {
  const collectionName = moduleName === 'primegear' ? 'primegear_clients' : 'cine_clients';
  const clientsCollection = collection(db, collectionName);

  try {
      const q = query(
          clientsCollection,
          where("userId", "==", userId),
          where("clientName", ">=", prefix),
          where("clientName", "<=", prefix + "\uf8ff"),
          orderBy("clientName"),
          limit(10) // Limit results to top 10 suggestions
      );
      const querySnapshot = await getDocs(q);
      return querySnapshot.docs.map(doc => doc.data());
  } catch (error) {
      console.error("Error fetching clients:", error);
      return [];
  }
};


const handleClientSearch = debounce(async (e) => {
  const prefix = e.target.value.trim();
  setClientName(prefix);

  if (prefix && moduleName && userId) {
      const fetchedClients = await fetchClients(prefix, moduleName, userId);
      setClients(fetchedClients);
  }
}, 300); // 300ms delay




  // Adjust the layout on component mount for better responsiveness
  useEffect(() => {
    // Adjust elements to ensure consistent viewport width
    const viewportWidth = window.innerWidth;
    if (viewportWidth < 768) {
      document.querySelectorAll('.form-section, .quotation-preview').forEach(el => {
        el.style.marginLeft = '0';
        el.style.marginRight = '0';
      });
    }
  }, []);

  // Check if it's the user's first login
  useEffect(() => {
    const firstLogin = localStorage.getItem('firstLogin');
    const hasAgreedToTerms = localStorage.getItem('hasAgreedToTerms');

    if (firstLogin && !hasAgreedToTerms) {
      setShowTermsModal(true); // Show the terms modal if it's the first login
    }
  }, []);

  // Handle agree and continue action for the terms modal
  const handleAgreeAndContinue = () => {
    localStorage.setItem('hasAgreedToTerms', 'true');
    setShowTermsModal(false);
  };
  

  useEffect(() => {
    setInvoiceId(generateDocumentId());
  
    const savedData = JSON.parse(localStorage.getItem('InvoiceData'));
    if (savedData) {
      setClientName(savedData.clientName || '');
      setClientAddress(savedData.clientAddress || '');
      setEmail(savedData.email || '');
      setJobName(savedData.jobName || '');
      setAttentionTo(savedData.attentionTo || '');
      setItems(Array.isArray(savedData.items) ? savedData.items : []);
      // setDate(savedData.date || new Date().toISOString().slice(0, 10));
      setCurrency(savedData.currency || 'USD');
      setDiscount(savedData.discount || 0);
    }
  }, []);
  
  

  useEffect(() => {
    setIsSaving(true); // Indicate saving has started
  
    const timeout = setTimeout(() => {
      const data = {
        clientName,
        clientAddress,
        email,
        attentionTo,
        items,
        date,
        currency,
        discount,
        jobName,
      };
      localStorage.setItem('InvoiceData', JSON.stringify(data));
      setIsSaving(false); // Indicate saving is complete
    }, 500);
  
    return () => clearTimeout(timeout); // Clear timeout on cleanup
  }, [clientName, clientAddress, email, jobName, attentionTo, items, date, currency, discount]);
  

  const handleAddItem = () => {
    if (editIndex === -1) {
      // If no item is being edited, add a new item
      setItems([...items, { description: itemDescription, quantity: itemQuantity, price: itemPrice, days: itemDays }]);
    } else {
      // Edit existing item
      const updatedItems = [...items];
      updatedItems[editIndex] = { description: itemDescription, quantity: itemQuantity, price: itemPrice, days: itemDays };
      setItems(updatedItems);
      setEditIndex(-1); // Reset editIndex after editing
    }
    setShowModal(false);
    setItemDescription('');
    setItemQuantity(1);
    setItemPrice(0);
    setItemDays(1); // Reset days after adding
  };


  const handleEditItem = (index) => {
    setEditIndex(index);
    const itemToEdit = items[index];
    setItemDescription(itemToEdit.description);
    setItemQuantity(itemToEdit.quantity);
    setItemPrice(itemToEdit.price);
    setItemDays(itemToEdit.days); // Set the days for editing
    setShowModal(true); // Show modal with populated fields
  };


  const handleRemoveItem = (index) => {
    const newItems = items.filter((_, i) => i !== index);
    setItems(newItems);
  };

  // Currency symbol based on selection
  const getCurrencySymbol = () => (currency === 'USD' ? '$' : 'Ksh');

  const calculateTotal = () => {
    return items.reduce((total, item) => total + item.quantity * item.price * item.days, 0).toFixed(2);
  };


  const [insuranceRate, setInsuranceRate] = useState(0); // Initial rate for insurance is 0%
  
  // Handler for changing insurance rate
  const handleInsuranceChange = (e) => {
    setInsuranceRate(Number(e.target.value)); // Update insurance rate based on dropdown selection
  };
  
  // Calculate Insurance based on selected rate
  const calculateInsurance = () => {
    return (calculateTotal() * (insuranceRate / 100)).toFixed(2); // Apply the selected insurance rate (either 0% or 5%)
  };

  const calculateDiscount = (amount) => {
    return ((amount * discount) / 100).toFixed(2); // Apply selected discount
  };

  const calculateVAT = (amount) => {
    return ((amount * vatRate) / 100).toFixed(2); // VAT based on selected rate
  };


  const calculateNetTotal = () => {
    const total = Math.round(calculateTotal() * 100) / 100;
    const insurance = Math.round(calculateInsurance() * 100) / 100;
    const discountedTotal = total + insurance - calculateDiscount(total + insurance);
    const vat = Math.round(calculateVAT(discountedTotal) * 100) / 100;
    return Math.round((discountedTotal + vat) * 100) / 100;
  };
  



  const formatCurrency = (amount) => {
    return new Intl.NumberFormat('en-US', {
      style: 'currency',
      currency: currency === 'USD' ? 'USD' : 'KES',
      minimumFractionDigits: 2,
    }).format(amount);
  };

  const generateDocumentId = () => {
      const now = new Date();
      const prefix = documentType === 'Invoice' ? 'IVN' : 'QTN';
      const timestamp = `${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}${String(now.getSeconds()).padStart(2, '0')}`;
      return `${prefix}${timestamp}`;
};

useEffect(() => {
  setInvoiceId(generateDocumentId()); // Unified function for both types
}, [documentType]);

const downloadInvoiceAsPDF = () => {
  const newDocumentId = generateDocumentId(); // Reuse unified function
  setInvoiceId(newDocumentId);

  const element = componentRef.current;

  const options = {
    margin: [10, 10, 10, 10],
    filename: `${newDocumentId}.pdf`,
    html2canvas: {
      scale: 2,
      useCORS: true,
      onclone: (clonedDocument) => {
        const watermark = clonedDocument.createElement('div');
        watermark.style.position = 'fixed';
        watermark.style.top = '0';
        watermark.style.left = '0';
        watermark.style.width = '100%';
        watermark.style.height = '100%';
        // watermark.style.background = `url(${watermarkcine}) center center / contain no-repeat`;
        watermark.style.opacity = '0.1';
        watermark.style.pointerEvents = 'none';
        watermark.style.zIndex = '-1';
        console.log(clonedDocument); // Check if content is as expected
        clonedDocument.body.appendChild(watermark);
      },
    },
    jsPDF: { unit: 'pt', format: 'a4', orientation: 'portrait' },
  };

  html2pdf()
    .set(options)
    .from(element)
    .save();
};



  return (
    <div className="App">
    <h1>{documentType} Generator</h1>

      <div className="invoice-layout">
        {/* Left Side: Form Inputs */}
        <div className="form-section">
        {isSaving && <p>Saving...</p>}

         {/* Dropdown to Select Document Type */}
         <div>
            <label>Document Type: </label>
            <select value={documentType} onChange={(e) => setDocumentType(e.target.value)}>
              <option value="Invoice">Invoice</option>
              <option value="Quote">Quote</option>
            </select>
          </div>

          <div className="flex flex-col justify-center">
            
            <div className="flex flex-col">
              <label>Enter client Name: </label>
              <input
                name="text"
                id="name"
                // placeholder="Enter your name"
                maxLength={56}
                autoComplete="off"
                type="text"
                value={clientName}
                onChange={(e) => setClientName(e.target.value)}
                placeholder={`Enter client name`}
              />
            </div>
            <div>
              <label htmlFor="address">Enter client Address: </label>
              <textarea
                name="address"
                id="address"
                placeholder="Enter client address"
                autoComplete="off"
                rows={3}
                type="text"
                value={clientAddress}
                onChange={(e) => setClientAddress(e.target.value)}
                style={{
                  width: '100%',           // Ensures textarea takes full width of the parent container
                  padding: '10px',          // Adds space inside the textarea
                  lineHeight: '1.1',        // Adjusts space between lines
                  fontSize: '1rem',         // Adjust font size for better readability
                  borderRadius: '5px',      // Optional: Round the corners slightly
                  border: '1px solid #ccc', // Optional: Subtle border
                }}
              />
            </div>
            <div>
              <label htmlFor="email">Enter client email: </label>
              <input
                name="email"
                id="email"
                datatype="email"
                placeholder="Enter your email"
                maxLength={255}
                autoComplete="off"
                type="email"
                value={email}
                onChange={(e) => setEmail(e.target.value)}
              />
            </div>

            {/* New Attention To field */}
            <div>
              <label htmlFor="attention">Attention to: </label>
              <textarea
                rows={2}
                name="attentionTo"
                id="attentionTo"
                placeholder="Enter name for Attention"
                autoComplete="off"
                maxLength={56}
                type="text"
                value={attentionTo}
                onChange={(e) => setAttentionTo(e.target.value)}
                style={{
                  width: '100%',           // Ensures textarea takes full width of the parent container
                  padding: '10px',          // Adds space inside the textarea
                  lineHeight: '1.1',        // Adjusts space between lines
                  fontSize: '1rem',         // Adjust font size for better readability
                  borderRadius: '5px',      // Optional: Round the corners slightly
                  border: '1px solid #ccc', // Optional: Subtle border
                }}
              />
            </div>

            <div>
              <label htmlFor="email">Enter job name : </label>
              <input
                name="job name"
                id="job name"
                datatype="job name"
                placeholder="Enter job name"
                maxLength={255}
                autoComplete="off"
                type="text"
                value={jobName}
                onChange={(e) => setJobName(e.target.value)}
              />
            </div>
            
            <div>
              <label>{documentType} Date: </label>
              <input
                type="date"
                value={date}
                onChange={(e) => setDate(e.target.value)}
              />
          </div>

            
            {/* Additional Notes Textarea */}
            <div>
              <label htmlFor="additionalNotes">Additional Notes: </label>
              <textarea
                id="additionalNotes"
                placeholder="Enter any additional notes here"
                rows={4}
                value={additionalNotes}
                onChange={(e) => setAdditionalNotes(e.target.value)}
                style={{ width: '90%', resize: 'vertical' }} // Keep formatting consistent with other inputs
              />
            </div>

            {/* Items Section */}
            <h3>Items</h3>
            {items.length === 0 && <p>No items added yet</p>}
            <table className="invoice-table-cine">
              <thead>
                <tr>
                  <th>Description</th>
                  <th>Quantity</th>
                  <th>Days</th> {/* New Days column */}
                  <th>Total</th>
                  <th></th> {/* Add an Actions header for the buttons */}
                </tr>
              </thead>
              <tbody>
                {items.map((item, index) => (
                  <tr key={index}>
                    <td>{item.description}</td>
                    <td>{item.quantity}</td>
                    <td>{item.days}</td> {/* Display Days */}
                    <td>{(item.quantity * item.price * item.days).toFixed(2)}</td> {/* Multiply by days */}                    <td>
                      {/* Smaller Edit and Remove icons */}
                      <button 
                        onClick={() => handleEditItem(index)} 
                        className="icon-button"
                        title="Edit Item"
                      >
                        ✏️
                      </button>
                      <button 
                        onClick={() => handleRemoveItem(index)} 
                        className="icon-button"
                        title="Remove Item"
                      >
                        🗑️
                      </button>
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>


            <div style={{ marginTop: '10px' }}>
              <button onClick={() => setShowModal(true)}>Add Item</button>
              {items.length > 0 && (
                <button style={{ marginLeft: '10px' }} onClick={() => handleRemoveItem(items.length - 1)}>
                  Remove Last Item
                </button>
              )}
            </div>

            {/* Discount and currency dropdown */}
            <div className="dropdown-container">
              <div>
                <label htmlFor="discount">Discount:</label>
                <select
                  id="discount"
                  value={discount}
                  onChange={(e) => setDiscount(Number(e.target.value))}
                >
                  {[...Array(51).keys()].map((val) => (
                    <option key={val} value={val}>
                      {val}%
                    </option>
                  ))}
                </select>
              </div>
              
              <div>
                <label>Currency:</label>
                <select value={currency} onChange={(e) => setCurrency(e.target.value)}>
                  <option value="USD">USD</option>
                  <option value="KSH">KSH</option>
                </select>
              </div>
            </div>
            <div>
              <label>VAT:</label>
              <select
                value={vatRate}
                onChange={(e) => setVatRate(Number(e.target.value))}
              >
                <option value={0}>0%</option>
                <option value={16}>16%</option>
              </select>
            </div>

            <div>
                <label>Insurance: </label>
                <select value={insuranceRate} onChange={handleInsuranceChange}>
                    <option value={0}>0%</option>
                    <option value={5}>5%</option>
                </select>
          </div>
          </div>
        </div>

        {/* Right Side: Invoice Preview */}
        <div ref={componentRef} className="quotation-preview">
        <h2>{documentType.toUpperCase()}</h2>

        {/* <div className="watermark-cine">
            <img src={watermarkcine} alt="Watermark" />
          </div> */}
          <div className="content">
            <div className="quotation-header">
              <div className="cine-logo-section">
                {/* <img src={CinelogoBase64} alt="Company Logo" /> */}
              </div>
              <div className="quotation-details">
              <p><strong>{documentType} No:</strong> {InvoiceId}</p>
              <p><strong>{documentType} Date:</strong> {date}</p>
                <p><strong>Valid For:</strong> 14 days</p>
              </div>
            </div>

            <div className="quotation-top">
              <div className="client-details"
              style={{ 
                fontSize: '1rem',   // Ensures readable text size
                padding: '10px',    // Adds internal spacing for a cleaner layout
                borderRadius: '5px' // Optional: Smooth rounded corners
              }}>
                <h3>{documentType} to</h3>
                <p style={{ margin: 0 }}>{clientName}</p>
          <p className="client-address">
            {clientAddress.split('\n').map((line, index) => (
              <span key={index}>
                {line}
                <br />
              </span>
            ))}
          </p>
          <p style={{ margin: 0 }}>{email}</p>
              </div>
              <div className="company-details">
                <h3>{documentType} by</h3>
                <p>company xyz</p>
                <p>town xyz, Nairobi</p>
                <p>companyxyz@example.com</p>
                <p>(+254) 705-441-305</p>
              </div>
            </div>
            <p style={{ fontSize: '0.9em' }}>
              <strong>Attention to:</strong>{' '}
              {attentionTo.split('\n').map((line, index) => (
                <React.Fragment key={index}>
                  {line}
                  <br />
                </React.Fragment>
              ))}
            </p>
            <p className='jobname' style={{ margin: 0 , fontSize: '0.9rem'}}> <strong>Job name: </strong> {jobName}</p>

            <h3>Item description</h3>
            <table className="quotation-table-cine">
              <thead>
                <tr>
                  <th>Description</th>
                  <th>Quantity</th>
                  <th>Days</th> {/* New Days column */}
                  <th>Unit Price</th>
                  <th>Total</th>
                </tr>
              </thead>

              <tbody>
                {items.map((item, index) => (
                  <tr key={index}>
                     <td>{item.description}</td>
                    <td>{item.quantity}</td>
                    <td>{item.days}</td> {/* Display Days */}
                    <td>{item.price.toFixed(2)}</td>
                    <td>{(item.quantity * item.price * item.days).toFixed(2)}</td> {/* Multiply by days */}                  </tr>
                ))}
              </tbody>

            </table>

            {/* <div className="total-section">
              <p><strong>Subtotal:</strong> ${calculateTotal()}</p>
              <p><strong>Insurance (5%):</strong> ${calculateInsurance()}</p>
              <p><strong>Discount ({discount}%):</strong> -${calculateDiscount(parseFloat(calculateTotal()) + parseFloat(calculateInsurance()))}</p>
              <p><strong>VAT (16%):</strong> +${calculateVAT(parseFloat(calculateTotal()) + parseFloat(calculateInsurance()) - parseFloat(calculateDiscount(parseFloat(calculateTotal()) + parseFloat(calculateInsurance()))))}</p>
              <h3 className="total">Net Total: ${calculateNetTotal()}</h3>
            </div> */}

            <div className="total-container">
              <div className="total-section">
                <table>
                  <tbody>
                    <tr>
                      <th>Subtotal:</th>
                      <td>{getCurrencySymbol()}{calculateTotal()}</td>
                    </tr>
                    <tr>
                    <th>Insurance ({insuranceRate}%):</th>
                    <td>{formatCurrency(calculateInsurance())}</td>
                    </tr>
                    <tr>
                      <th>Discount ({discount}%):</th>
                      <td>-{getCurrencySymbol()}{calculateDiscount(parseFloat(calculateTotal()) + parseFloat(calculateInsurance()))}</td>
                    </tr>
                    <tr>
                      <th>VAT ({vatRate}%):</th>
                      <td>+{getCurrencySymbol()}{calculateVAT(parseFloat(calculateTotal()) + parseFloat(calculateInsurance()) - parseFloat(calculateDiscount(parseFloat(calculateTotal()) + parseFloat(calculateInsurance()))))}</td>
                    </tr>
                    <tr>
                      <th><strong>Net Total:</strong></th>
                      <td><strong>{getCurrencySymbol()}{calculateNetTotal()}</strong></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>

            {/* Additional Notes in Preview */}
            <h3>Additional Notes:</h3>
            <div className="additional-notes-preview" style={{ border: '2px solid #c1d8e0', padding: '10px', minHeight: '100px', borderRadius: '4px'  }}>
              {additionalNotes ? additionalNotes : <em>No additional notes provided.</em>}
            </div>
            

            {/* Bank details section */}
            <div className="quotation-footer">
              {currency === 'USD' ? (
              <p>
                  <strong>Bank: xyz Bank, Branch: barnch xyz, Account Name: xyz limited</strong><br />
                  <strong>Account Number: 00000000000 , Branch Code: 000, Bank Code: 000</strong><br />
                  <strong>Postal Address: PO Box - 00000 - 00000</strong>
              {/* <strong>Postal Address: P.O.Box - 30238 - 00100</strong> */}

            </p>
          ) : (
            <p>
                  <strong>Bank: xyz Bank, Branch: barnch xyz, Account Name: xyz limited</strong><br />
                  <strong>Account Number: 00000000000 , Branch Code: 000, Bank Code: 000</strong><br />
                  <strong>Postal Address: PO Box - 00000 - 00000</strong>
              {/* <strong>Postal Address: P.O.Box - 30238 - 00100</strong> */}

            </p>
              )}
            </div>


            <p className="copyright-tag">&copy; {new Date().getFullYear()} primeGearAfrica. All rights reserved.</p>
          </div>
        </div>
      </div>
      <div style={{ textAlign: 'center', marginTop: '20px', marginBottom: '20px' }}>
          <button onClick={downloadInvoiceAsPDF}>Generate {documentType}</button>
    </div>

      {showModal && (
        <div className="modal">
          <div className="modal-content">
            <h2>Add Item</h2>
            <div>
              <label>Description: </label>
              <input
                type="text"
                value={itemDescription}
                onChange={(e) => setItemDescription(e.target.value)}
              />
            </div>
            <div>
              <label>Quantity: </label>
              <input
                type="text"  // Change from 'number' to 'text'
                value={itemQuantity}
                onChange={(e) => setItemQuantity(parseFloat(e.target.value) || 0)}  // Ensure it's handled as a number
              />
            </div>
            <div>
              <label>Price: </label>
              <input
                type="text"  // Change from 'number' to 'text'
                value={itemPrice}
                onChange={(e) => setItemPrice(parseFloat(e.target.value) || 0)}  // Ensure it's handled as a number
              />
            </div>
            <div>
              <label>Days: </label> {/* Allow decimals, restrict alphabets */}
              <input
                type="text"
                value={itemDays}
                onChange={(e) => setItemDays(e.target.value.replace(/[^0-9.]/g, ''))}  // Only allow numbers and decimal points
              />
            </div>

            <button onClick={handleAddItem}>Add</button>
            <button className="cancel-button" onClick={() => setShowModal(false)}>Cancel</button>
          </div>
        </div>
      )}
    </div>
  );
}

export default Invoice;
